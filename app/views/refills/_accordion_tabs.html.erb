<div id='accordion-container'>
  <ul class="accordion-tabs">
    <li class="tab-header-and-content">
      <a href="#" class="is-active tab-link">Patient </a>
      <section>
        <div class='script-tabs'>
          <h3> Patient Information </h3>
          <p><%= render 'patients/patient_info', patient: @patient %></p>
        </div>
      </section>
    </li>
    <li class="tab-header-and-content">
      <a href="#" class="tab-link">Prescription</a>
      <section>
        <div class='script-tabs'>
          <h3> Prescription Information </h3>
          <p><%= render 'script_info', script: @script %></p>
        </div>
      </section>
    </li>
    <li class="tab-header-and-content">
      <a href="#" class="tab-link">Physician</a>
      <section>
        <div class='script-tabs'>
          <h3> Physician Information </h3>
          <p><%= render 'physicians/physician_info', physician: @script.physician %></p> 
        </div> 
      </section>
    </li>
    <li class="tab-header-and-content">
      <a href="#" class="is-active tab-link">Clinic</a>
      <section>
        <div class='script-tabs'>
          <h3> Clinic Information </h3>
          <p><%= render 'clinics/clinic_info', physician: @script.physician %></p>
        </div>
      </section>
    </li>
    <li class="tab-header-and-content">
      <a href="#" class="tab-link">Code</a>
      <section>
        <div id="qr-code-show" class="qrcode">
          <img src="data:image/svg+xml;utf8,<%= @qr_code %>">
          <div class='email-link'>
            <%= button_to 'Send Script to Patient', '#', method: :get %>
            <p> Email: <%= @patient.user.email %>
            <% if request.referer.include?("/patients/#{@patient.id}/scripts/") %>
              <p> CODE SENT </p>
              <% send_patient_code(@qr_code) %>
            <% end %>
          </div>
        </div>
      </section>
    </li>

  </ul>

  <script>
    $(document).ready(function () {
      $('.accordion-tabs').each(function(index) {
        $(this).children('li').first().children('a').addClass('is-active').next().addClass('is-open').show();
      });

      $('.accordion-tabs').on('click', 'li > a', function(event) {
        if (!$(this).hasClass('is-active')) {
          event.preventDefault();
          var accordionTabs = $(this).closest('.accordion-tabs')
          accordionTabs.find('.is-open').removeClass('is-open').hide();

          $(this).next().toggleClass('is-open').toggle();
          accordionTabs.find('.is-active').removeClass('is-active');
          $(this).addClass('is-active');
        } else {
          event.preventDefault();
        }
      });
    });
  </script>
</div>
